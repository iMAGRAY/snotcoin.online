# Система аутентификации

## Описание оптимизации
Система аутентификации была оптимизирована для упрощения и повышения производительности:

1. **Устранение дублирования данных**
   - Токены теперь хранятся только в cookies, без дублирования в базе данных
   - Это уменьшает зависимость от БД и улучшает производительность

2. **Логика аутентификации**
   - Farcaster используется для первичной валидации пользователя через Neynar API
   - JWT токены используются для поддержания сессии без повторных обращений к внешним API
   - Refresh токены для долгосрочного сохранения сессии

3. **Преимущества подхода**
   - Уменьшение нагрузки на базу данных
   - Работа без зависимости от внешних API после первичной аутентификации
   - Улучшение производительности за счет локальной проверки токенов

## Поток данных

1. **Аутентификация**:
   - Пользователь авторизуется через Farcaster
   - Сервер проверяет данные через Neynar API и генерирует токены
   - Токены сохраняются в защищенных cookies

2. **Проверка сессии**:
   - JWT токен проверяется локально без обращений к БД
   - При истечении JWT используется refresh token

3. **Обновление**:
   - Refresh токен используется для создания новой пары токенов
   - Новые токены сохраняются в cookies

## API эндпоинты

- `/api/auth/providers/farcaster` - аутентификация через Farcaster
- `/api/auth/refresh` - обновление токенов
- `/api/auth/logout` - выход пользователя 